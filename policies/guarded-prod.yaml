version: v1
rules:
  - id: guarded-prod-read-workspace
    action_type: fs.read
    resource: file://workspace/**
    decision: ALLOW
  - id: guarded-prod-write-docs
    action_type: fs.write
    resource: file://workspace/docs/**
    decision: ALLOW
    obligations:
      sandbox_mode: container
  - id: guarded-prod-apply-patch-docs
    action_type: repo.apply_patch
    resource: repo://local/workspace
    decision: ALLOW
    obligations:
      sandbox_mode: container
  - id: guarded-prod-http-allowlist
    action_type: net.http_request
    resource: url://api.example.com/**
    decision: ALLOW
    obligations:
      net_allowlist:
        - api.example.com
  - id: guarded-prod-exec-allowlist
    action_type: process.exec
    resource: file://workspace/
    decision: ALLOW
    obligations:
      sandbox_mode: container
      exec_allowlist:
        - [git, status]
        - [go, test]
